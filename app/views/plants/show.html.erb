<div class="container">
  <% if current_user == @plant.user %>
    <div class="d-flex justify-content-center show-notification">
      <%= link_to user_path do %>
        <p>Guess What? You own this plant! Congratulations! <br> Click here to return to your profile and see more of your plants</p>
      <% end %>
    </div>
  <% end %>

  <div id="plant-id" class="show-plant" data-id= <%= @plant.id %>>
    <div>
      <img class="show-plant-image" src="https://images.unsplash.com/photo-1502394202744-021cfbb17454?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1489&q=80" alt="">
    </div>
    <div class="show-info">
      <div class="show-details">
        <div>
          <% if @plant.category == "tree" %>
            <h3><i class="fas fa-tree"></i> <%= @plant.name %></h3>
          <% elsif @plant.category == "flower" %>
            <h3><i class="fas fa-fan"> </i> <%= @plant.name %></h3>
          <% elsif @plant.category == "bush" %>
            <h3><i class="fab fa-pagelines"></i> <%= @plant.name %></h3>
          <% else %>
            <h3><i class="fas fa-cannabis"></i> <%= @plant.name %></h3>
          <% end %>
        </div>
        <div><h3>£<%= @plant.price %></h3></div>
      </div>
      <div class="show-description"><%= @plant.description %></div>

        <form class="show-form" id="show-form">
          <div class="show-input">
            <label for="quantity">Quantity</label>
            <input id="quantity" name="quantity" type="number" value="1" min="1" increment="1">
          </div>
          <div class="show-input">
            <label for="total">Total</label>
            <input id="total" value="£<%= @plant.price %>" disabled>
          </div>
          <div class="show-btns">
            <%= link_to plants_path do %>
              <button class="btn btn-success cancel">Cancel</button>
            <% end %>
            <% if current_user == @plant.user %>
                <button class="btn show-btn-color">Buy</button>
            <% else %>
                <button id="buy-btn" class="btn btn-success" type="submit" >Buy</button>
            <% end %>
          </div>
        </form>
    </div>
  </div>

<script type="text/javascript">
  const quantity = document.getElementById("quantity");
  const total = document.getElementById("total");

  quantity.addEventListener("click", (e) => {
    total.value = `£${ quantity.value * <%= @plant.price %> }`
  })

  const buy = document.getElementById("show-form");

  buy.addEventListener("submit", (e) => {
    e.preventDefault();
    window.location.href = window.location.href + `/transactions/new?quantity=` + quantity.value;
  })

</script>
